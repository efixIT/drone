<script>
  (async function() {
    const gallery = document.getElementById('gallery');
    gallery.innerHTML = ''; 

    // ... (keep your existing config, currentPath, apiUrl, fetch code unchanged up to htmlFiles.forEach)

    htmlFiles.forEach(file => {
      const nameWithoutExt = file.name.replace(/\.html$/i, '');
      
      // Debug: Log exactly what we're using
      console.log('File detected:', file.name);
      console.log('Derived base name:', nameWithoutExt);
      console.log('Current path prefix:', currentPath);
      
      let thumbUrl = `${currentPath}${nameWithoutExt}-thumb.png`;
      console.log('Trying thumbnail URL:', thumbUrl);
      console.log('Full resolved URL (should match direct link):', new URL(thumbUrl, window.location.origin).href);

      const card = document.createElement('a');
      card.href = file.name;
      card.className = 'card';
      card.target = '_blank';

      const img = new Image();
      img.src = thumbUrl;
      img.alt = nameWithoutExt;
      img.className = 'thumbnail';
      img.loading = 'lazy';

      img.onload = () => console.log('Thumbnail loaded successfully for:', nameWithoutExt);
      img.onerror = () => {
        console.error('Failed to load PNG, trying JPG fallback...');
        thumbUrl = `${currentPath}${nameWithoutExt}-thumb.jpg`;
        console.log('Fallback URL:', thumbUrl);
        img.src = thumbUrl;
        img.onerror = () => {
          console.error('Both PNG and JPG failed for:', nameWithoutExt);
          // Placeholder code...
          const placeholder = document.createElement('div');
          placeholder.className = 'placeholder';
          placeholder.textContent = 'No Preview';
          card.querySelector('.thumb-container')?.replaceChild(placeholder, img);
        };
      };

      card.innerHTML = `
        <div class="thumb-container">${img.outerHTML}</div>
        <div class="info">
          <div class="title">${nameWithoutExt.replace(/-/g, ' ')}</div>
          <div class="desc">Gaussian splat model â€¢ Click to view & inspect</div>
        </div>
      `;

      gallery.appendChild(card);
    });

    // ... (keep catch block)
  })();
</script>
